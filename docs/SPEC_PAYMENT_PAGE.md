# ğŸ’³ í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ í˜ì´ì§€ êµ¬í˜„ ê³„íš

> **ë²„ì „**: 1.0  
> **ì‘ì„±ì¼**: 2026ë…„ 2ì›” 3ì¼  
> **ìƒíƒœ**: êµ¬í˜„ ì¤€ë¹„ ì™„ë£Œ  
> **ìš°ì„ ìˆœìœ„**: P1

---

## ğŸ“‹ ëª©ì°¨

1. [í˜„í™© ë¶„ì„](#1-í˜„í™©-ë¶„ì„)
2. [ê¸°ìˆ  ìŠ¤íƒ í˜„í™©](#2-ê¸°ìˆ -ìŠ¤íƒ-í˜„í™©)
3. [ë°ì´í„°ë² ì´ìŠ¤ í˜„í™©](#3-ë°ì´í„°ë² ì´ìŠ¤-í˜„í™©)
4. [í˜„ì¬ êµ¬í˜„ ìƒíƒœ](#4-í˜„ì¬-êµ¬í˜„-ìƒíƒœ)
5. [ê°œì„  í•„ìš” ì‚¬í•­](#5-ê°œì„ -í•„ìš”-ì‚¬í•­)
6. [êµ¬í˜„ ê³„íš](#6-êµ¬í˜„-ê³„íš)
7. [UI/UX ì„¤ê³„](#7-uiux-ì„¤ê³„)
8. [API ì„¤ê³„](#8-api-ì„¤ê³„)
9. [ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸](#9-ë³´ì•ˆ-ì²´í¬ë¦¬ìŠ¤íŠ¸)
10. [í…ŒìŠ¤íŠ¸ ê³„íš](#10-í…ŒìŠ¤íŠ¸-ê³„íš)
11. [Task ëª©ë¡](#11-task-ëª©ë¡)

---

## 1. í˜„í™© ë¶„ì„

### 1.1 í”„ë¡œì íŠ¸ ê°œìš”

**ì‹¸ì¸í•´ì£¼ì„¸ìš” (SignPlease)**ëŠ” ê·¼ë¡œê³„ì•½ì„œ ì‘ì„± ë° ì„œëª… í”Œë«í¼ì…ë‹ˆë‹¤. ì‚¬ì—…ìëŠ” í¬ë ˆë”§ì„ êµ¬ë§¤í•˜ì—¬ ê³„ì•½ì„œë¥¼ ì‘ì„±í•˜ê³ , ê·¼ë¡œìì—ê²Œ ì„œëª…ì„ ìš”ì²­í•©ë‹ˆë‹¤.

### 1.2 ê²°ì œ ì‹œìŠ¤í…œ ëª©ì 

| ëª©ì         | ì„¤ëª…                                      |
| ----------- | ----------------------------------------- |
| í¬ë ˆë”§ ì¶©ì „ | ì‚¬ì—…ìê°€ ê³„ì•½ì„œ ì‘ì„±ì— í•„ìš”í•œ í¬ë ˆë”§ êµ¬ë§¤ |
| ìˆ˜ìµ ëª¨ë¸   | í¬ë ˆë”§ íŒë§¤ë¥¼ í†µí•œ ì„œë¹„ìŠ¤ ìˆ˜ìµí™”          |
| ì‚¬ìš©ì ê²½í—˜ | ê°„í¸í•˜ê³  ì•ˆì „í•œ ê²°ì œ ê²½í—˜ ì œê³µ            |

### 1.3 í˜„ì¬ ìƒíƒœ ìš”ì•½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    í˜„ì¬ ê²°ì œ ì‹œìŠ¤í…œ ìƒíƒœ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚  âœ… í† ìŠ¤í˜ì´ë¨¼ì¸  SDK ì„¤ì¹˜ë¨ (@tosspayments/tosspayments-sdk) â”‚
â”‚  âœ… í™˜ê²½ ë³€ìˆ˜ ì„¤ì • ì™„ë£Œ (í…ŒìŠ¤íŠ¸ í‚¤)                          â”‚
â”‚  âœ… ê²°ì œ ì¤€ë¹„ API êµ¬í˜„ë¨ (/api/payment/prepare)              â”‚
â”‚  âœ… ê²°ì œ í™•ì¸ API êµ¬í˜„ë¨ (/api/payment/confirm)              â”‚
â”‚  âœ… PaymentWidget ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ë¨                            â”‚
â”‚  âœ… í¬ë ˆë”§ ì¶©ì „ í˜ì´ì§€ êµ¬í˜„ë¨ (/pricing)                     â”‚
â”‚  âœ… ê²°ì œ ë‚´ì—­ í˜ì´ì§€ êµ¬í˜„ë¨ (/payment-history)               â”‚
â”‚  âœ… í¬ë ˆë”§ ì‹œìŠ¤í…œ DB ìŠ¤í‚¤ë§ˆ ì™„ë£Œ                             â”‚
â”‚  âœ… add_credit / use_credit RPC í•¨ìˆ˜ êµ¬í˜„ë¨                  â”‚
â”‚                                                             â”‚
â”‚  ğŸŸ¡ ê°œì„  í•„ìš”: UI/UX ìµœì í™”, ì—ëŸ¬ ì²˜ë¦¬ ê°•í™”                   â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. ê¸°ìˆ  ìŠ¤íƒ í˜„í™©

### 2.1 í•µì‹¬ ê¸°ìˆ 

| ê¸°ìˆ          | ë²„ì „   | ìš©ë„                       |
| ------------ | ------ | -------------------------- |
| Next.js      | 16.1.4 | App Router ê¸°ë°˜ í”„ë ˆì„ì›Œí¬ |
| React        | 19.2.3 | UI ë¼ì´ë¸ŒëŸ¬ë¦¬              |
| TypeScript   | 5.x    | íƒ€ì… ì•ˆì •ì„±                |
| Supabase     | 2.91.1 | ë°ì´í„°ë² ì´ìŠ¤, ì¸ì¦         |
| Tailwind CSS | 4.x    | ìŠ¤íƒ€ì¼ë§                   |

### 2.2 ê²°ì œ ê´€ë ¨ íŒ¨í‚¤ì§€

| íŒ¨í‚¤ì§€                           | ë²„ì „  | ìš©ë„                  |
| -------------------------------- | ----- | --------------------- |
| `@tosspayments/tosspayments-sdk` | 2.5.0 | í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œìœ„ì ¯ |

### 2.3 í™˜ê²½ ë³€ìˆ˜ í˜„í™©

```bash
# .env.localì— ì„¤ì •ë¨
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq  # í´ë¼ì´ì–¸íŠ¸ í‚¤
TOSS_SECRET_KEY=test_sk_zXLkKEypNArWmo50nX3lmeaxYG5R              # ì‹œí¬ë¦¿ í‚¤

# ì•± URL (ê²°ì œ ì„±ê³µ/ì‹¤íŒ¨ ë¦¬ë‹¤ì´ë ‰íŠ¸ìš©)
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### 2.4 í‚¤ íƒ€ì… í™•ì¸

| í‚¤            | íŒ¨í„´        | ìš©ë„                   | ìƒíƒœ         |
| ------------- | ----------- | ---------------------- | ------------ |
| í´ë¼ì´ì–¸íŠ¸ í‚¤ | `test_ck_*` | í”„ë¡ íŠ¸ì—”ë“œ ìœ„ì ¯ ì´ˆê¸°í™” | âœ… í…ŒìŠ¤íŠ¸ í‚¤ |
| ì‹œí¬ë¦¿ í‚¤     | `test_sk_*` | ë°±ì—”ë“œ ê²°ì œ ìŠ¹ì¸       | âœ… í…ŒìŠ¤íŠ¸ í‚¤ |

> âš ï¸ **í”„ë¡œë•ì…˜ ë°°í¬ ì‹œ**: `live_ck_*`, `live_sk_*`ë¡œ êµì²´ í•„ìš”

---

## 3. ë°ì´í„°ë² ì´ìŠ¤ í˜„í™©

### 3.1 ê²°ì œ ê´€ë ¨ í…Œì´ë¸”

#### payments (ê²°ì œ ë‚´ì—­)

| Column              | Type        | Nullable | Default           | Description            |
| ------------------- | ----------- | -------- | ----------------- | ---------------------- |
| `id`                | uuid        | NO       | gen_random_uuid() | PK                     |
| `user_id`           | uuid        | NO       | -                 | FK â†’ profiles.id       |
| `order_id`          | text        | NO       | -                 | ì£¼ë¬¸ ID (í† ìŠ¤í˜ì´ë¨¼ì¸ ) |
| `payment_key`       | text        | YES      | NULL              | ê²°ì œ í‚¤ (í† ìŠ¤í˜ì´ë¨¼ì¸ ) |
| `amount`            | integer     | NO       | -                 | ê²°ì œ ê¸ˆì•¡ (ì›)         |
| `product_name`      | text        | NO       | -                 | ìƒí’ˆëª…                 |
| `credits_contract`  | integer     | NO       | 0                 | ì§€ê¸‰ ê³„ì•½ì„œ í¬ë ˆë”§ ìˆ˜  |
| `credits_ai_review` | integer     | NO       | 0                 | ì§€ê¸‰ AIê²€í†  í¬ë ˆë”§ ìˆ˜  |
| `status`            | text        | NO       | 'pending'         | ê²°ì œ ìƒíƒœ              |
| `paid_at`           | timestamptz | YES      | NULL              | ê²°ì œ ì™„ë£Œ ì¼ì‹œ         |
| `receipt_url`       | text        | YES      | NULL              | ì˜ìˆ˜ì¦ URL             |
| `created_at`        | timestamptz | NO       | now()             | ìƒì„±ì¼ì‹œ               |

**status ê°’:**

- `pending`: ê²°ì œ ëŒ€ê¸°
- `completed`: ê²°ì œ ì™„ë£Œ
- `failed`: ê²°ì œ ì‹¤íŒ¨
- `cancelled`: ê²°ì œ ì·¨ì†Œ

#### credits (í¬ë ˆë”§ ë³´ìœ )

| Column        | Type        | Nullable | Default           | Description      |
| ------------- | ----------- | -------- | ----------------- | ---------------- |
| `id`          | uuid        | NO       | gen_random_uuid() | PK               |
| `user_id`     | uuid        | NO       | -                 | FK â†’ profiles.id |
| `credit_type` | credit_type | NO       | -                 | í¬ë ˆë”§ ì¢…ë¥˜      |
| `amount`      | integer     | NO       | 0                 | ë³´ìœ  ìˆ˜ëŸ‰        |
| `updated_at`  | timestamptz | NO       | now()             | ìˆ˜ì •ì¼ì‹œ         |

**credit_type enum:**

- `contract`: ê³„ì•½ì„œ ì‘ì„± í¬ë ˆë”§
- `ai_review`: AI ë…¸ë¬´ì‚¬ ê²€í†  í¬ë ˆë”§ (í˜„ì¬ ë¬´ë£Œí™”ë¨)

#### credit_transactions (ê±°ë˜ ë‚´ì—­)

| Column          | Type        | Nullable | Default           | Description      |
| --------------- | ----------- | -------- | ----------------- | ---------------- |
| `id`            | uuid        | NO       | gen_random_uuid() | PK               |
| `user_id`       | uuid        | NO       | -                 | FK â†’ profiles.id |
| `credit_type`   | credit_type | NO       | -                 | í¬ë ˆë”§ ì¢…ë¥˜      |
| `amount`        | integer     | NO       | -                 | ë³€ë™ ìˆ˜ëŸ‰ (+/-)  |
| `balance_after` | integer     | NO       | -                 | ê±°ë˜ í›„ ì”ì•¡     |
| `description`   | text        | NO       | -                 | ê±°ë˜ ì„¤ëª…        |
| `reference_id`  | uuid        | YES      | NULL              | ê´€ë ¨ ID          |
| `created_at`    | timestamptz | NO       | now()             | ê±°ë˜ ì¼ì‹œ        |

### 3.2 RLS ì •ì±…

```sql
-- payments: ë³¸ì¸ ê²°ì œë§Œ ì¡°íšŒ
CREATE POLICY payments_select_own ON payments
  FOR SELECT TO authenticated
  USING ((SELECT auth.uid()) = user_id);

-- credits: ë³¸ì¸ í¬ë ˆë”§ë§Œ ì¡°íšŒ
CREATE POLICY credits_select_own ON credits
  FOR SELECT TO authenticated
  USING ((SELECT auth.uid()) = user_id);

-- credit_transactions: ë³¸ì¸ ê±°ë˜ë‚´ì—­ë§Œ ì¡°íšŒ
CREATE POLICY credit_transactions_select_own ON credit_transactions
  FOR SELECT TO authenticated
  USING ((SELECT auth.uid()) = user_id);
```

### 3.3 DB í•¨ìˆ˜

```sql
-- í¬ë ˆë”§ ì¶©ì „
CREATE FUNCTION add_credit(
  p_user_id uuid,
  p_credit_type credit_type,
  p_amount integer,
  p_description text,
  p_reference_id uuid DEFAULT NULL
) RETURNS integer;

-- í¬ë ˆë”§ ì‚¬ìš©
CREATE FUNCTION use_credit(
  p_user_id uuid,
  p_credit_type credit_type,
  p_amount integer,
  p_description text,
  p_reference_id uuid DEFAULT NULL
) RETURNS boolean;
```

---

## 4. í˜„ì¬ êµ¬í˜„ ìƒíƒœ

### 4.1 íŒŒì¼ êµ¬ì¡°

```
signplease/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ payment/
â”‚   â”‚       â”œâ”€â”€ prepare/
â”‚   â”‚       â”‚   â””â”€â”€ route.ts       # POST: ê²°ì œ ì¤€ë¹„ (payments í…Œì´ë¸”ì— pending ì €ì¥)
â”‚   â”‚       â””â”€â”€ confirm/
â”‚   â”‚           â””â”€â”€ route.ts       # GET: ê²°ì œ í™•ì¸ (í† ìŠ¤ ìŠ¹ì¸ â†’ í¬ë ˆë”§ ì§€ê¸‰)
â”‚   â””â”€â”€ (protected)/
â”‚       â”œâ”€â”€ pricing/
â”‚       â”‚   â”œâ”€â”€ page.tsx           # Server Component (í¬ë ˆë”§ ì¡°íšŒ)
â”‚       â”‚   â””â”€â”€ pricing-page.tsx   # Client Component (ìƒí’ˆ ì„ íƒ UI)
â”‚       â””â”€â”€ payment-history/
â”‚           â”œâ”€â”€ page.tsx           # Server Component (ê²°ì œ ë‚´ì—­ ì¡°íšŒ)
â”‚           â””â”€â”€ payment-history-page.tsx  # Client Component (ëª©ë¡ í‘œì‹œ)
â”œâ”€â”€ components/
â”‚   â””â”€â”€ payment/
â”‚       â””â”€â”€ PaymentWidget.tsx      # í† ìŠ¤í˜ì´ë¨¼ì¸  ìœ„ì ¯ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ lib/
    â””â”€â”€ constants/
        â””â”€â”€ products.ts            # ìƒí’ˆ ì •ë³´ (ê°€ê²©, í¬ë ˆë”§ ìˆ˜)
```

### 4.2 ê²°ì œ í”Œë¡œìš° (í˜„ì¬)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        í˜„ì¬ ê²°ì œ í”Œë¡œìš°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  1. ì‚¬ìš©ìê°€ /pricing í˜ì´ì§€ ì ‘ê·¼                                â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  2. ìƒí’ˆ ì„ íƒ (5ê±´/15ê±´/50ê±´)                                    â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  3. "ê²°ì œí•˜ê¸°" ë²„íŠ¼ í´ë¦­                                         â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  4. PaymentWidget ëª¨ë‹¬ í‘œì‹œ                                      â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€â”€ orderId ìƒì„± (nanoid)                                   â”‚
â”‚      â”œâ”€â”€ /api/payment/prepare í˜¸ì¶œ                               â”‚
â”‚      â”‚   â””â”€â”€ payments í…Œì´ë¸”ì— pending ìƒíƒœë¡œ ì €ì¥                â”‚
â”‚      â”œâ”€â”€ í† ìŠ¤í˜ì´ë¨¼ì¸  SDK ì´ˆê¸°í™”                                  â”‚
â”‚      â”œâ”€â”€ widgets.setAmount() í˜¸ì¶œ                                â”‚
â”‚      â”œâ”€â”€ widgets.renderPaymentMethods() í˜¸ì¶œ                     â”‚
â”‚      â””â”€â”€ widgets.renderAgreement() í˜¸ì¶œ                          â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  5. ì‚¬ìš©ìê°€ ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ & ê²°ì œ ì§„í–‰                           â”‚
â”‚      â”‚                                                          â”‚
â”‚      â–¼                                                          â”‚
â”‚  6. widgets.requestPayment() í˜¸ì¶œ                                â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€â”€ ì„±ê³µ ì‹œ: successUrlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸                         â”‚
â”‚      â”‚   â””â”€â”€ /api/payment/confirm?paymentKey=...&orderId=...     â”‚
â”‚      â”‚                                                          â”‚
â”‚      â””â”€â”€ ì‹¤íŒ¨ ì‹œ: failUrlë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸                            â”‚
â”‚          â””â”€â”€ /pricing?error=...                                  â”‚
â”‚                                                                 â”‚
â”‚  7. /api/payment/confirm ì²˜ë¦¬                                    â”‚
â”‚      â”‚                                                          â”‚
â”‚      â”œâ”€â”€ í† ìŠ¤í˜ì´ë¨¼ì¸  ìŠ¹ì¸ API í˜¸ì¶œ (POST /v1/payments/confirm)   â”‚
â”‚      â”œâ”€â”€ payments í…Œì´ë¸” status â†’ 'completed' ì—…ë°ì´íŠ¸            â”‚
â”‚      â”œâ”€â”€ add_credit RPC í˜¸ì¶œ (í¬ë ˆë”§ ì§€ê¸‰)                       â”‚
â”‚      â””â”€â”€ /pricing?success=trueë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸                       â”‚
â”‚                                                                 â”‚
â”‚  8. ì„±ê³µ í† ìŠ¤íŠ¸ í‘œì‹œ & í¬ë ˆë”§ ì”ì•¡ ê°±ì‹                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 ìƒí’ˆ êµ¬ì„± (í˜„ì¬)

| ìƒí’ˆ ID     | ìƒí’ˆëª…      | ê°€ê²©     | í¬ë ˆë”§ | ê±´ë‹¹ ê°€ê²© | ë¹„ê³    |
| ----------- | ----------- | -------- | ------ | --------- | ------ |
| `credit_5`  | í¬ë ˆë”§ 5ê±´  | 4,900ì›  | 5ê±´    | 980ì›     | -      |
| `credit_15` | í¬ë ˆë”§ 15ê±´ | 12,900ì› | 15ê±´   | 860ì›     | ì¸ê¸°   |
| `credit_50` | í¬ë ˆë”§ 50ê±´ | 39,000ì› | 50ê±´   | 780ì›     | ìµœì €ê°€ |

### 4.4 PaymentWidget êµ¬í˜„ í˜„í™©

```typescript
// components/payment/PaymentWidget.tsx (ìš”ì•½)

'use client';

interface PaymentWidgetProps {
  productId: string;
  productName: string;
  amount: number;
  credits: number;
  customerKey: string;  // user.id ì‚¬ìš©
  onSuccess: () => void;
  onClose: () => void;
}

export function PaymentWidget({ ... }: PaymentWidgetProps) {
  const widgetsRef = useRef<ReturnType<typeof TossPayments.widgets> | null>(null);
  const isRenderedRef = useRef(false);

  useEffect(() => {
    // TossPayments ì´ˆê¸°í™”
    const tossPayments = TossPayments(process.env.NEXT_PUBLIC_TOSS_CLIENT_KEY!);
    widgetsRef.current = tossPayments.widgets({ customerKey });
  }, [customerKey]);

  useEffect(() => {
    // ìœ„ì ¯ ë Œë”ë§ (í•œ ë²ˆë§Œ)
    const renderWidgets = async () => {
      await widgetsRef.current?.setAmount({ currency: 'KRW', value: amount });

      if (!isRenderedRef.current) {
        await widgetsRef.current?.renderPaymentMethods({ selector: '#payment-method' });
        await widgetsRef.current?.renderAgreement({ selector: '#agreement' });
        isRenderedRef.current = true;
      }
    };
    renderWidgets();
  }, [amount]);

  const handlePayment = async () => {
    const orderId = nanoid();

    // ê²°ì œ ì¤€ë¹„ API í˜¸ì¶œ
    await fetch('/api/payment/prepare', {
      method: 'POST',
      body: JSON.stringify({ orderId, amount, productId, productName, credits }),
    });

    // ê²°ì œ ìš”ì²­
    await widgetsRef.current?.requestPayment({
      orderId,
      orderName: productName,
      successUrl: `${window.location.origin}/api/payment/confirm`,
      failUrl: `${window.location.origin}/pricing?error=payment_failed`,
      customerEmail: user.email,
      customerName: user.name,
    });
  };

  return (
    <div>
      <div id="payment-method"></div>
      <div id="agreement"></div>
      <button onClick={handlePayment}>ê²°ì œí•˜ê¸°</button>
    </div>
  );
}
```

---

## 5. ê°œì„  í•„ìš” ì‚¬í•­

### 5.1 ê¸°ëŠ¥ ê°œì„ 

| ì˜ì—­      | í˜„ì¬ ìƒíƒœ       | ê°œì„  ë°©í–¥                     | ìš°ì„ ìˆœìœ„ |
| --------- | --------------- | ----------------------------- | -------- |
| ì—ëŸ¬ ì²˜ë¦¬ | ê¸°ë³¸ ì—ëŸ¬ í‘œì‹œ  | ìƒì„¸ ì—ëŸ¬ ë©”ì‹œì§€ ë° ë³µêµ¬ ì•ˆë‚´ | ğŸ”´ ë†’ìŒ  |
| ë¡œë”© ìƒíƒœ | ê¸°ë³¸ ìŠ¤í”¼ë„ˆ     | ê²°ì œ ë‹¨ê³„ë³„ ì§„í–‰ ìƒíƒœ í‘œì‹œ    | ğŸŸ¡ ì¤‘ê°„  |
| ê²°ì œ ì·¨ì†Œ | ë²„íŠ¼ë§Œ ì¡´ì¬     | ì·¨ì†Œ ì‹œ í™•ì¸ ëª¨ë‹¬ ì¶”ê°€        | ğŸŸ¡ ì¤‘ê°„  |
| ì˜ìˆ˜ì¦    | URL ë§í¬ë§Œ ì œê³µ | ì¸ì•± ì˜ìˆ˜ì¦ ë·°ì–´              | ğŸŸ¢ ë‚®ìŒ  |

### 5.2 UI/UX ê°œì„ 

| ì˜ì—­      | í˜„ì¬ ìƒíƒœ     | ê°œì„  ë°©í–¥                     | ìš°ì„ ìˆœìœ„ |
| --------- | ------------- | ----------------------------- | -------- |
| ìƒí’ˆ ì„ íƒ | ë¼ë””ì˜¤ ë²„íŠ¼   | ì¹´ë“œ í˜•íƒœ ì„ íƒ UI             | ğŸŸ¡ ì¤‘ê°„  |
| ê°€ê²© í‘œì‹œ | ìˆ«ìë§Œ í‘œì‹œ   | í• ì¸ìœ¨/ê±´ë‹¹ ê°€ê²© ê°•ì¡°         | ğŸŸ¡ ì¤‘ê°„  |
| ê²°ì œ ì™„ë£Œ | í† ìŠ¤íŠ¸ë§Œ í‘œì‹œ | ì„±ê³µ ëª¨ë‹¬ + í¬ë ˆë”§ ì• ë‹ˆë©”ì´ì…˜ | ğŸŸ¢ ë‚®ìŒ  |
| ê²°ì œ ë‚´ì—­ | ê¸°ë³¸ ë¦¬ìŠ¤íŠ¸   | ì›”ë³„ ê·¸ë£¹í•‘ + í†µê³„            | ğŸŸ¢ ë‚®ìŒ  |

### 5.3 ë³´ì•ˆ ê°œì„ 

| ì˜ì—­      | í˜„ì¬ ìƒíƒœ              | ê°œì„  ë°©í–¥                | ìš°ì„ ìˆœìœ„ |
| --------- | ---------------------- | ------------------------ | -------- |
| ê¸ˆì•¡ ê²€ì¦ | prepare â†” confirm ë¹„êµ | ì„œë²„ DB ê¸ˆì•¡ê³¼ 3ì¤‘ ê²€ì¦  | ğŸ”´ ë†’ìŒ  |
| ì¤‘ë³µ ê²°ì œ | orderId ìœ ë‹ˆí¬ ì œì•½    | ë™ì‹œ ìš”ì²­ ë°©ì§€ ë½ ì¶”ê°€   | ğŸ”´ ë†’ìŒ  |
| ë¡œê¹…      | ê¸°ë³¸ ë¡œê¹…              | ê²°ì œ ì‹œë„/ì‹¤íŒ¨ ìƒì„¸ ë¡œê¹… | ğŸŸ¡ ì¤‘ê°„  |

---

## 6. êµ¬í˜„ ê³„íš

### 6.1 Phase 1: ê¸°ëŠ¥ ì•ˆì •í™” (í•„ìˆ˜)

#### 6.1.1 ê¸ˆì•¡ ê²€ì¦ ê°•í™”

```typescript
// app/api/payment/confirm/route.ts

export async function GET(request: Request) {
  const { paymentKey, orderId, amount } = parseParams(request);

  // 1. DBì—ì„œ pending ìƒíƒœì˜ ì£¼ë¬¸ ì¡°íšŒ
  const { data: payment } = await supabase
    .from('payments')
    .select('*')
    .eq('order_id', orderId)
    .eq('status', 'pending')
    .single();

  if (!payment) {
    return redirect('/pricing?error=order_not_found');
  }

  // 2. ê¸ˆì•¡ ê²€ì¦ (DB ê¸ˆì•¡ vs URL íŒŒë¼ë¯¸í„°)
  if (payment.amount !== Number(amount)) {
    console.error('[ê²°ì œ ì˜¤ë¥˜] ê¸ˆì•¡ ë¶ˆì¼ì¹˜:', {
      orderId,
      dbAmount: payment.amount,
      urlAmount: amount,
    });
    return redirect('/pricing?error=amount_mismatch');
  }

  // 3. í† ìŠ¤í˜ì´ë¨¼ì¸  ìŠ¹ì¸ API í˜¸ì¶œ
  const confirmResponse = await fetch(
    'https://api.tosspayments.com/v1/payments/confirm',
    {
      method: 'POST',
      headers: {
        Authorization: `Basic ${Buffer.from(TOSS_SECRET_KEY + ':').toString('base64')}`,
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        paymentKey,
        orderId,
        amount: Number(amount),
      }),
    }
  );

  // 4. í† ìŠ¤ ì‘ë‹µ ê¸ˆì•¡ ì¬ê²€ì¦
  const tossResult = await confirmResponse.json();
  if (tossResult.totalAmount !== payment.amount) {
    console.error('[ê²°ì œ ì˜¤ë¥˜] í† ìŠ¤ ê¸ˆì•¡ ë¶ˆì¼ì¹˜:', {
      orderId,
      dbAmount: payment.amount,
      tossAmount: tossResult.totalAmount,
    });
    // í™˜ë¶ˆ ì²˜ë¦¬ í•„ìš”
    return redirect('/pricing?error=amount_verification_failed');
  }

  // 5. ê²°ì œ ì™„ë£Œ ì²˜ë¦¬
  // ...
}
```

#### 6.1.2 ì¤‘ë³µ ê²°ì œ ë°©ì§€

```typescript
// app/api/payment/prepare/route.ts

export async function POST(request: Request) {
  const { orderId, amount, productId, productName, credits } =
    await request.json();

  // ì¤‘ë³µ orderId ì²´í¬
  const { data: existing } = await supabase
    .from('payments')
    .select('id')
    .eq('order_id', orderId)
    .single();

  if (existing) {
    return NextResponse.json(
      { error: 'ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ ì£¼ë¬¸ì…ë‹ˆë‹¤.' },
      { status: 400 }
    );
  }

  // INSERT (UNIQUE ì œì•½ì¡°ê±´ìœ¼ë¡œ ë™ì‹œì„± ì²˜ë¦¬)
  const { error } = await supabase.from('payments').insert({
    user_id: user.id,
    order_id: orderId,
    amount,
    product_name: productName,
    credits_contract: credits,
    status: 'pending',
  });

  if (error?.code === '23505') {
    // unique_violation
    return NextResponse.json(
      { error: 'ì´ë¯¸ ì²˜ë¦¬ ì¤‘ì¸ ì£¼ë¬¸ì…ë‹ˆë‹¤.' },
      { status: 400 }
    );
  }

  return NextResponse.json({ success: true });
}
```

#### 6.1.3 ì—ëŸ¬ ì²˜ë¦¬ ê°œì„ 

```typescript
// í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ ì²˜ë¦¬

try {
  await widgets.requestPayment({ ... });
} catch (error: any) {
  switch (error.code) {
    case 'USER_CANCEL':
      toast.info('ê²°ì œê°€ ì·¨ì†Œë˜ì—ˆì–´ìš”.');
      break;
    case 'INVALID_CARD_COMPANY':
      toast.error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ì¹´ë“œì‚¬ì˜ˆìš”. ë‹¤ë¥¸ ì¹´ë“œë¡œ ì‹œë„í•´ì£¼ì„¸ìš”.');
      break;
    case 'EXCEED_MAX_CARD_INSTALLMENT_PLAN':
      toast.error('í• ë¶€ ê°œì›” ìˆ˜ê°€ ì´ˆê³¼ëì–´ìš”.');
      break;
    case 'NOT_ENOUGH_BALANCE':
      toast.error('ì”ì•¡ì´ ë¶€ì¡±í•´ìš”.');
      break;
    default:
      toast.error(`ê²°ì œ ì˜¤ë¥˜: ${error.message || 'ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'}`);
      console.error('[ê²°ì œ ì˜¤ë¥˜]', error);
  }
}
```

### 6.2 Phase 2: UI/UX ê°œì„ 

#### 6.2.1 ìƒí’ˆ ì„ íƒ UI ê°œì„ 

```tsx
// ì¹´ë“œ í˜•íƒœ ìƒí’ˆ ì„ íƒ

function ProductCard({ product, selected, onSelect }) {
  return (
    <button
      onClick={() => onSelect(product.id)}
      className={clsx(
        'w-full p-5 rounded-2xl border-2 transition-all text-left',
        selected
          ? 'border-blue-500 bg-blue-50'
          : 'border-gray-200 bg-white active:bg-gray-50'
      )}
    >
      {/* ì¸ê¸° ë°°ì§€ */}
      {product.popular && (
        <span className="inline-block px-2 py-0.5 mb-2 text-xs font-medium text-blue-600 bg-blue-100 rounded-full">
          ì¸ê¸°
        </span>
      )}

      <div className="flex justify-between items-center">
        <div>
          <p className="text-lg font-bold text-gray-900">{product.credits}ê±´</p>
          <p className="text-sm text-gray-500">
            ê±´ë‹¹ {formatCurrency(product.pricePerCredit)}ì›
          </p>
        </div>
        <p className="text-xl font-bold text-gray-900">
          {formatCurrency(product.price)}ì›
        </p>
      </div>

      {/* í• ì¸ìœ¨ í‘œì‹œ */}
      {product.discount > 0 && (
        <p className="mt-2 text-sm text-green-600 font-medium">
          {product.discount}% í• ì¸
        </p>
      )}
    </button>
  );
}
```

#### 6.2.2 ê²°ì œ ì§„í–‰ ìƒíƒœ í‘œì‹œ

```tsx
// ê²°ì œ ë‹¨ê³„ í‘œì‹œ

function PaymentProgress({ step }: { step: 'prepare' | 'widget' | 'confirm' }) {
  const steps = [
    { key: 'prepare', label: 'ê²°ì œ ì¤€ë¹„ ì¤‘' },
    { key: 'widget', label: 'ê²°ì œ ì§„í–‰ ì¤‘' },
    { key: 'confirm', label: 'ê²°ì œ ì™„ë£Œ ì²˜ë¦¬ ì¤‘' },
  ];

  return (
    <div className="flex items-center justify-center gap-2 py-4">
      {steps.map((s, i) => (
        <React.Fragment key={s.key}>
          <div
            className={clsx(
              'w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium',
              step === s.key
                ? 'bg-blue-500 text-white animate-pulse'
                : steps.findIndex((x) => x.key === step) > i
                  ? 'bg-green-500 text-white'
                  : 'bg-gray-200 text-gray-500'
            )}
          >
            {steps.findIndex((x) => x.key === step) > i ? 'âœ“' : i + 1}
          </div>
          {i < steps.length - 1 && <div className="w-8 h-0.5 bg-gray-200" />}
        </React.Fragment>
      ))}
    </div>
  );
}
```

#### 6.2.3 ê²°ì œ ì™„ë£Œ ëª¨ë‹¬

```tsx
// ê²°ì œ ì„±ê³µ ëª¨ë‹¬

function PaymentSuccessModal({ credits, onClose }) {
  return (
    <BottomSheet open={true} onClose={onClose}>
      <div className="flex flex-col items-center py-8">
        {/* ì„±ê³µ ì•„ì´ì½˜ */}
        <div className="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4">
          <svg
            className="w-8 h-8 text-green-500"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              strokeLinecap="round"
              strokeLinejoin="round"
              strokeWidth={2}
              d="M5 13l4 4L19 7"
            />
          </svg>
        </div>

        <h2 className="text-xl font-bold text-gray-900 mb-2">
          ê²°ì œê°€ ì™„ë£Œëì–´ìš”!
        </h2>
        <p className="text-gray-500 mb-6">í¬ë ˆë”§ {credits}ê±´ì´ ì¶©ì „ëì–´ìš”</p>

        {/* í¬ë ˆë”§ ì• ë‹ˆë©”ì´ì…˜ */}
        <div className="text-4xl font-bold text-blue-500 animate-bounce-slow mb-8">
          +{credits}
        </div>

        <Button onClick={onClose} fullWidth>
          í™•ì¸
        </Button>
      </div>
    </BottomSheet>
  );
}
```

### 6.3 Phase 3: ê³ ê¸‰ ê¸°ëŠ¥ (ì„ íƒ)

#### 6.3.1 ê²°ì œ ë‚´ì—­ ì›”ë³„ ê·¸ë£¹í•‘

```tsx
// ì›”ë³„ ê·¸ë£¹í•‘ëœ ê²°ì œ ë‚´ì—­

function PaymentHistoryByMonth({ payments }) {
  const grouped = useMemo(() => {
    return payments.reduce((acc, payment) => {
      const month = format(new Date(payment.paid_at), 'yyyyë…„ Mì›”');
      if (!acc[month]) acc[month] = [];
      acc[month].push(payment);
      return acc;
    }, {});
  }, [payments]);

  return (
    <div className="space-y-6">
      {Object.entries(grouped).map(([month, items]) => (
        <div key={month}>
          <h3 className="text-sm font-medium text-gray-500 mb-3">{month}</h3>
          <div className="space-y-3">
            {items.map((payment) => (
              <PaymentItem key={payment.id} payment={payment} />
            ))}
          </div>
        </div>
      ))}
    </div>
  );
}
```

#### 6.3.2 í¬ë ˆë”§ ì‚¬ìš© í†µê³„

```tsx
// í¬ë ˆë”§ ì‚¬ìš© í†µê³„

function CreditStats({ userId }) {
  const { data } = useCreditStats(userId);

  return (
    <div className="grid grid-cols-3 gap-4 p-4 bg-gray-50 rounded-2xl">
      <Stat label="ì¶©ì „" value={data.totalCharged} color="blue" />
      <Stat label="ì‚¬ìš©" value={data.totalUsed} color="gray" />
      <Stat label="ì”ì•¡" value={data.balance} color="green" />
    </div>
  );
}
```

---

## 7. UI/UX ì„¤ê³„

### 7.1 í¬ë ˆë”§ ì¶©ì „ í˜ì´ì§€ (`/pricing`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† í¬ë ˆë”§ ì¶©ì „                   â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  í˜„ì¬ ë³´ìœ  í¬ë ˆë”§               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚      ğŸ’³ 12ê±´              â”‚  â”‚  â† í˜„ì¬ ì”ì•¡ í‘œì‹œ
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  ì¶©ì „í•  í¬ë ˆë”§ì„ ì„ íƒí•˜ì„¸ìš”     â”‚  â† ì„¹ì…˜ íƒ€ì´í‹€
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 5ê±´                       â”‚  â”‚
â”‚  â”‚ ê±´ë‹¹ 980ì›        4,900ì› â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ì¸ê¸° 15ê±´                 â”‚  â”‚  â† ì¸ê¸° ë°°ì§€
â”‚  â”‚ ê±´ë‹¹ 860ì›  12% â†“ 12,900ì›â”‚  â”‚  â† í• ì¸ìœ¨ í‘œì‹œ
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 50ê±´                      â”‚  â”‚
â”‚  â”‚ ê±´ë‹¹ 780ì›  20% â†“ 39,000ì›â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       ê²°ì œí•˜ê¸° ğŸ’³         â”‚  â”‚  â† Primary ë²„íŠ¼
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  ê²°ì œ ë‚´ì—­ ë³´ê¸° >              â”‚  â† ë§í¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.2 ê²°ì œ ìœ„ì ¯ ëª¨ë‹¬

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    â”€â”€ â”€â”€        â”‚  â† Handle
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  í¬ë ˆë”§ 15ê±´ ê²°ì œ               â”‚  â† ìƒí’ˆëª…
â”‚  12,900ì›                       â”‚  â† ê²°ì œ ê¸ˆì•¡
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚   [í† ìŠ¤í˜ì´ë¨¼ì¸  ìœ„ì ¯]      â”‚  â”‚  â† ê²°ì œ ìˆ˜ë‹¨ ì„ íƒ
â”‚  â”‚   - ì¹´ë“œ                  â”‚  â”‚
â”‚  â”‚   - ê³„ì¢Œì´ì²´              â”‚  â”‚
â”‚  â”‚   - í† ìŠ¤í˜ì´              â”‚  â”‚
â”‚  â”‚   - ì¹´ì¹´ì˜¤í˜ì´            â”‚  â”‚
â”‚  â”‚                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   [ì•½ê´€ ë™ì˜ ìœ„ì ¯]         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   12,900ì› ê²°ì œí•˜ê¸°       â”‚  â”‚  â† Primary ë²„íŠ¼
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  ìœ„ ë‚´ìš©ì„ í™•ì¸í–ˆìœ¼ë©°,          â”‚
â”‚  ê²°ì œì— ë™ì˜í•©ë‹ˆë‹¤.             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.3 ê²°ì œ ì™„ë£Œ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚             âœ…                  â”‚  â† ì„±ê³µ ì•„ì´ì½˜
â”‚                                 â”‚
â”‚       ê²°ì œê°€ ì™„ë£Œëì–´ìš”!        â”‚
â”‚                                 â”‚
â”‚        í¬ë ˆë”§ 15ê±´ì´            â”‚
â”‚        ì¶©ì „ëì–´ìš”               â”‚
â”‚                                 â”‚
â”‚           +15                   â”‚  â† í¬ë ˆë”§ ì• ë‹ˆë©”ì´ì…˜
â”‚                                 â”‚
â”‚  í˜„ì¬ ë³´ìœ  í¬ë ˆë”§: 27ê±´         â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          í™•ì¸             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  ì˜ìˆ˜ì¦ ë³´ê¸°                    â”‚  â† ë§í¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.4 ê²°ì œ ì‹¤íŒ¨ í™”ë©´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                 â”‚
â”‚             âš ï¸                  â”‚  â† ê²½ê³  ì•„ì´ì½˜
â”‚                                 â”‚
â”‚       ê²°ì œì— ì‹¤íŒ¨í–ˆì–´ìš”         â”‚
â”‚                                 â”‚
â”‚  ì¹´ë“œ í•œë„ë¥¼ í™•ì¸í•˜ê±°ë‚˜          â”‚
â”‚  ë‹¤ë¥¸ ê²°ì œ ìˆ˜ë‹¨ì„ ì´ìš©í•´ì£¼ì„¸ìš”    â”‚
â”‚                                 â”‚
â”‚  ì—ëŸ¬ ì½”ë“œ: INVALID_CARD        â”‚  â† ì—ëŸ¬ ìƒì„¸
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚       ë‹¤ì‹œ ì‹œë„í•˜ê¸°        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚         ì·¨ì†Œ                    â”‚  â† ë§í¬
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7.5 ê²°ì œ ë‚´ì—­ í˜ì´ì§€ (`/payment-history`)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† ê²°ì œ ë‚´ì—­                     â”‚  â† Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  2026ë…„ 2ì›”                     â”‚  â† ì›”ë³„ ê·¸ë£¹
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ í¬ë ˆë”§ 15ê±´     2ì›” 3ì¼   â”‚  â”‚
â”‚  â”‚ 12,900ì›          ì˜ìˆ˜ì¦ > â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ í¬ë ˆë”§ 5ê±´      2ì›” 1ì¼   â”‚  â”‚
â”‚  â”‚ 4,900ì›           ì˜ìˆ˜ì¦ > â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  2026ë…„ 1ì›”                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ í¬ë ˆë”§ 50ê±´     1ì›” 28ì¼  â”‚  â”‚
â”‚  â”‚ 39,000ì›          ì˜ìˆ˜ì¦ > â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  ...                            â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. API ì„¤ê³„

### 8.1 ê²°ì œ ì¤€ë¹„ API

**Endpoint:** `POST /api/payment/prepare`

**Request:**

```typescript
interface PrepareRequest {
  orderId: string; // í´ë¼ì´ì–¸íŠ¸ì—ì„œ ìƒì„±í•œ ì£¼ë¬¸ ID (nanoid)
  amount: number; // ê²°ì œ ê¸ˆì•¡
  productId: string; // ìƒí’ˆ ID (credit_5, credit_15, credit_50)
  productName: string; // ìƒí’ˆëª…
  credits: number; // ì§€ê¸‰í•  í¬ë ˆë”§ ìˆ˜
}
```

**Response:**

```typescript
interface PrepareResponse {
  success: boolean;
  error?: string;
}
```

**ì²˜ë¦¬ ë¡œì§:**

1. ì‚¬ìš©ì ì¸ì¦ í™•ì¸
2. ìƒí’ˆ ì •ë³´ ê²€ì¦ (ê°€ê²©, í¬ë ˆë”§ ìˆ˜)
3. payments í…Œì´ë¸”ì— pending ìƒíƒœë¡œ ì €ì¥
4. ì„±ê³µ ì‘ë‹µ ë°˜í™˜

### 8.2 ê²°ì œ í™•ì¸ API

**Endpoint:** `GET /api/payment/confirm`

**Query Parameters:**

- `paymentKey`: í† ìŠ¤í˜ì´ë¨¼ì¸  ê²°ì œ í‚¤
- `orderId`: ì£¼ë¬¸ ID
- `amount`: ê²°ì œ ê¸ˆì•¡

**ì²˜ë¦¬ ë¡œì§:**

1. URL íŒŒë¼ë¯¸í„° íŒŒì‹±
2. payments í…Œì´ë¸”ì—ì„œ ì£¼ë¬¸ ì¡°íšŒ (orderId, status='pending')
3. ê¸ˆì•¡ ê²€ì¦ (DB vs URL)
4. í† ìŠ¤í˜ì´ë¨¼ì¸  ìŠ¹ì¸ API í˜¸ì¶œ
5. ì‘ë‹µ ê²€ì¦ (ê¸ˆì•¡ ì¼ì¹˜ í™•ì¸)
6. payments ìƒíƒœ ì—…ë°ì´íŠ¸ (completed)
7. add_credit RPC í˜¸ì¶œ (í¬ë ˆë”§ ì§€ê¸‰)
8. ì„±ê³µ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸

**ì—ëŸ¬ ì²˜ë¦¬:**

- ì£¼ë¬¸ ì—†ìŒ: `/pricing?error=order_not_found`
- ê¸ˆì•¡ ë¶ˆì¼ì¹˜: `/pricing?error=amount_mismatch`
- í† ìŠ¤ ìŠ¹ì¸ ì‹¤íŒ¨: `/pricing?error={toss_error_code}`
- í¬ë ˆë”§ ì§€ê¸‰ ì‹¤íŒ¨: `/pricing?error=credit_grant_failed`

### 8.3 ì—ëŸ¬ ì½”ë“œ ì •ì˜

| ì½”ë“œ                   | ì„¤ëª…             | ì‚¬ìš©ì ë©”ì‹œì§€                                      |
| ---------------------- | ---------------- | -------------------------------------------------- |
| `order_not_found`      | ì£¼ë¬¸ ì •ë³´ ì—†ìŒ   | ê²°ì œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”.                        |
| `amount_mismatch`      | ê¸ˆì•¡ ë¶ˆì¼ì¹˜      | ê²°ì œ ê¸ˆì•¡ì´ ì¼ì¹˜í•˜ì§€ ì•Šì•„ìš”.                       |
| `already_processed`    | ì´ë¯¸ ì²˜ë¦¬ëœ ì£¼ë¬¸ | ì´ë¯¸ ì™„ë£Œëœ ê²°ì œì˜ˆìš”.                              |
| `credit_grant_failed`  | í¬ë ˆë”§ ì§€ê¸‰ ì‹¤íŒ¨ | í¬ë ˆë”§ ì§€ê¸‰ì— ì‹¤íŒ¨í–ˆì–´ìš”. ê³ ê°ì„¼í„°ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”. |
| `USER_CANCEL`          | ì‚¬ìš©ì ì·¨ì†Œ      | ê²°ì œê°€ ì·¨ì†Œëì–´ìš”.                                 |
| `INVALID_CARD_COMPANY` | ì¹´ë“œì‚¬ ë¯¸ì§€ì›    | ì§€ì›í•˜ì§€ ì•ŠëŠ” ì¹´ë“œì‚¬ì˜ˆìš”.                          |
| `NOT_ENOUGH_BALANCE`   | ì”ì•¡ ë¶€ì¡±        | ì”ì•¡ì´ ë¶€ì¡±í•´ìš”.                                   |

---

## 9. ë³´ì•ˆ ì²´í¬ë¦¬ìŠ¤íŠ¸

### 9.1 í•„ìˆ˜ ë³´ì•ˆ ì‚¬í•­

| í•­ëª©                | í˜„ì¬ ìƒíƒœ | ì¡°ì¹˜ ì‚¬í•­                           |
| ------------------- | --------- | ----------------------------------- |
| ì‹œí¬ë¦¿ í‚¤ ì„œë²„ ì „ìš© | âœ…        | `TOSS_SECRET_KEY`ëŠ” ì„œë²„ì—ì„œë§Œ ì‚¬ìš© |
| ê¸ˆì•¡ ì„œë²„ ê²€ì¦      | âœ…        | prepareì—ì„œ ì €ì¥, confirmì—ì„œ ê²€ì¦  |
| ì¤‘ë³µ ê²°ì œ ë°©ì§€      | âœ…        | orderId UNIQUE ì œì•½ì¡°ê±´             |
| ì¸ì¦ í™•ì¸           | âœ…        | ëª¨ë“  APIì—ì„œ auth.getUser() í˜¸ì¶œ    |
| RLS ì •ì±…            | âœ…        | ë³¸ì¸ ë°ì´í„°ë§Œ ì ‘ê·¼ ê°€ëŠ¥             |

### 9.2 ì¶”ê°€ ë³´ì•ˆ ê¶Œì¥ ì‚¬í•­

| í•­ëª©             | í˜„ì¬ ìƒíƒœ | ì¡°ì¹˜ ì‚¬í•­                       | ìš°ì„ ìˆœìœ„ |
| ---------------- | --------- | ------------------------------- | -------- |
| í† ìŠ¤ ê¸ˆì•¡ ì¬ê²€ì¦ | ğŸŸ¡        | confirm ì‘ë‹µì˜ totalAmount ê²€ì¦ | ğŸ”´ ë†’ìŒ  |
| Rate Limiting    | âŒ        | ê²°ì œ API rate limit ì ìš©        | ğŸŸ¡ ì¤‘ê°„  |
| ê²°ì œ ë¡œê¹…        | ğŸŸ¡        | ìƒì„¸ ë¡œê·¸ ê¸°ë¡ (IP, UA í¬í•¨)    | ğŸŸ¡ ì¤‘ê°„  |
| ì•Œë¦¼             | âŒ        | ê²°ì œ ì™„ë£Œ ì‹œ ê´€ë¦¬ì ì•Œë¦¼        | ğŸŸ¢ ë‚®ìŒ  |

### 9.3 í† ìŠ¤í˜ì´ë¨¼ì¸  ë³´ì•ˆ ê°€ì´ë“œë¼ì¸

```typescript
// ì‹œí¬ë¦¿ í‚¤ ì¸ì½”ë”© (ì˜¬ë°”ë¥¸ ë°©ì‹)
const encodedKey = Buffer.from(TOSS_SECRET_KEY + ':').toString('base64');
// ì£¼ì˜: ì‹œí¬ë¦¿ í‚¤ ë’¤ì— ì½œë¡ (:)ì„ ë¶™ì—¬ì•¼ í•¨

// ì¸ì¦ í—¤ë”
headers: {
  'Authorization': `Basic ${encodedKey}`,
  'Content-Type': 'application/json',
}
```

---

## 10. í…ŒìŠ¤íŠ¸ ê³„íš

### 10.1 ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸

| í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤      | ì˜ˆìƒ ê²°ê³¼                | í™•ì¸ |
| ------------------ | ------------------------ | ---- |
| ì •ìƒ ê²°ì œ í”Œë¡œìš°   | ê²°ì œ ì™„ë£Œ, í¬ë ˆë”§ ì¶©ì „   | â¬œ   |
| ê²°ì œ ì·¨ì†Œ (ì‚¬ìš©ì) | ê²°ì œ ì·¨ì†Œ, ì—ëŸ¬ ë©”ì‹œì§€   | â¬œ   |
| ì¹´ë“œ í•œë„ ì´ˆê³¼     | ì—ëŸ¬ ë©”ì‹œì§€, ì¬ì‹œë„ ì•ˆë‚´ | â¬œ   |
| ì”ì•¡ ë¶€ì¡±          | ì—ëŸ¬ ë©”ì‹œì§€, ì¬ì‹œë„ ì•ˆë‚´ | â¬œ   |
| ì¤‘ë³µ ê²°ì œ ì‹œë„     | ì—ëŸ¬ ë©”ì‹œì§€, ê²°ì œ ì°¨ë‹¨   | â¬œ   |
| ê¸ˆì•¡ ë³€ì¡° ì‹œë„     | ì—ëŸ¬, ê²°ì œ ì°¨ë‹¨          | â¬œ   |
| ë¹„ë¡œê·¸ì¸ ì ‘ê·¼      | ë¡œê·¸ì¸ í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ | â¬œ   |
| ê²ŒìŠ¤íŠ¸ ëª¨ë“œ ì ‘ê·¼   | ë¡œê·¸ì¸ ìœ ë„ ë°°ë„ˆ         | â¬œ   |

### 10.2 í…ŒìŠ¤íŠ¸ ì¹´ë“œ ì •ë³´

| í•­ëª©     | ê°’                 |
| -------- | ------------------ |
| ì¹´ë“œë²ˆí˜¸ | ì„ì˜ì˜ 16ìë¦¬ ìˆ«ì |
| ìœ íš¨ê¸°ê°„ | í˜„ì¬ ì´í›„ ë‚ ì§œ     |
| CVC      | ì„ì˜ì˜ 3ìë¦¬ ìˆ«ì  |
| ë¹„ë°€ë²ˆí˜¸ | ì„ì˜ì˜ 2ìë¦¬ ìˆ«ì  |

### 10.3 í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

#### ì‹œë‚˜ë¦¬ì˜¤ 1: ì •ìƒ ê²°ì œ

1. `/pricing` ì ‘ì†
2. ìƒí’ˆ ì„ íƒ (15ê±´)
3. "ê²°ì œí•˜ê¸°" í´ë¦­
4. ìœ„ì ¯ì—ì„œ ì¹´ë“œ ì„ íƒ
5. í…ŒìŠ¤íŠ¸ ì¹´ë“œ ì •ë³´ ì…ë ¥
6. ê²°ì œ ì™„ë£Œ
7. í¬ë ˆë”§ ì¶©ì „ í™•ì¸

#### ì‹œë‚˜ë¦¬ì˜¤ 2: ê²°ì œ ì·¨ì†Œ

1. ê²°ì œ ìœ„ì ¯ í‘œì‹œ
2. ë¸Œë¼ìš°ì € ë’¤ë¡œê°€ê¸° ë˜ëŠ” X ë²„íŠ¼
3. ì·¨ì†Œ ë©”ì‹œì§€ í™•ì¸

#### ì‹œë‚˜ë¦¬ì˜¤ 3: ì—ëŸ¬ ë³µêµ¬

1. ê²°ì œ ì‹¤íŒ¨ ë°œìƒ
2. ì—ëŸ¬ ë©”ì‹œì§€ í™•ì¸
3. "ë‹¤ì‹œ ì‹œë„í•˜ê¸°" í´ë¦­
4. ì¬ê²°ì œ ì§„í–‰

---

## 11. Task ëª©ë¡

### Phase 1: ê¸°ëŠ¥ ì•ˆì •í™” (í•„ìˆ˜)

| #   | Task                      | íŒŒì¼                            | ì˜ˆìƒ ì‹œê°„ | ìš°ì„ ìˆœìœ„ |
| --- | ------------------------- | ------------------------------- | --------- | -------- |
| 1.1 | ê¸ˆì•¡ 3ì¤‘ ê²€ì¦ ë¡œì§ ì¶”ê°€   | `/api/payment/confirm/route.ts` | 30ë¶„      | ğŸ”´       |
| 1.2 | ì¤‘ë³µ ê²°ì œ ë°©ì§€ ë½ ì¶”ê°€    | `/api/payment/prepare/route.ts` | 20ë¶„      | ğŸ”´       |
| 1.3 | í´ë¼ì´ì–¸íŠ¸ ì—ëŸ¬ ì²˜ë¦¬ ê°œì„  | `PaymentWidget.tsx`             | 30ë¶„      | ğŸ”´       |
| 1.4 | ê²°ì œ ë¡œê¹… ì¶”ê°€            | `/api/payment/*.ts`             | 20ë¶„      | ğŸŸ¡       |

### Phase 2: UI/UX ê°œì„ 

| #   | Task                  | íŒŒì¼                       | ì˜ˆìƒ ì‹œê°„ | ìš°ì„ ìˆœìœ„ |
| --- | --------------------- | -------------------------- | --------- | -------- |
| 2.1 | ìƒí’ˆ ì„ íƒ ì¹´ë“œ UI     | `pricing-page.tsx`         | 45ë¶„      | ğŸŸ¡       |
| 2.2 | ê²°ì œ ì§„í–‰ ìƒíƒœ í‘œì‹œ   | `PaymentWidget.tsx`        | 30ë¶„      | ğŸŸ¡       |
| 2.3 | ê²°ì œ ì™„ë£Œ ëª¨ë‹¬        | `PaymentSuccessModal.tsx`  | 30ë¶„      | ğŸŸ¡       |
| 2.4 | ê²°ì œ ì‹¤íŒ¨ í™”ë©´ ê°œì„    | `pricing-page.tsx`         | 20ë¶„      | ğŸŸ¡       |
| 2.5 | ê²°ì œ ë‚´ì—­ ì›”ë³„ ê·¸ë£¹í•‘ | `payment-history-page.tsx` | 30ë¶„      | ğŸŸ¢       |

### Phase 3: ê³ ê¸‰ ê¸°ëŠ¥ (ì„ íƒ)

| #   | Task                    | íŒŒì¼                            | ì˜ˆìƒ ì‹œê°„ | ìš°ì„ ìˆœìœ„ |
| --- | ----------------------- | ------------------------------- | --------- | -------- |
| 3.1 | í¬ë ˆë”§ ì‚¬ìš© í†µê³„        | `CreditStats.tsx`               | 45ë¶„      | ğŸŸ¢       |
| 3.2 | ì¸ì•± ì˜ìˆ˜ì¦ ë·°ì–´        | `ReceiptViewer.tsx`             | 1ì‹œê°„     | ğŸŸ¢       |
| 3.3 | ê²°ì œ ì•Œë¦¼ (ì´ë©”ì¼/í‘¸ì‹œ) | `/api/payment/confirm/route.ts` | 1ì‹œê°„     | ğŸŸ¢       |
| 3.4 | ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ         | `/admin/payments`               | 2ì‹œê°„     | ğŸŸ¢       |

### Phase 4: í”„ë¡œë•ì…˜ ì¤€ë¹„

| #   | Task                   | ì„¤ëª…                  | ì˜ˆìƒ ì‹œê°„ | ìš°ì„ ìˆœìœ„ |
| --- | ---------------------- | --------------------- | --------- | -------- |
| 4.1 | ë¼ì´ë¸Œ í‚¤ ì„¤ì •         | Vercel í™˜ê²½ ë³€ìˆ˜ ì„¤ì • | 10ë¶„      | ğŸ”´       |
| 4.2 | í† ìŠ¤í˜ì´ë¨¼ì¸  ìƒì  ì‹¬ì‚¬ | ìƒì  ì •ë³´ ë“±ë¡        | 1-3ì¼     | ğŸ”´       |
| 4.3 | ê²°ì œ í…ŒìŠ¤íŠ¸ (ë¼ì´ë¸Œ)   | ì‹¤ì œ ê²°ì œ í…ŒìŠ¤íŠ¸      | 30ë¶„      | ğŸ”´       |
| 4.4 | ëª¨ë‹ˆí„°ë§ ì„¤ì •          | ì—ëŸ¬ ì•Œë¦¼ ì„¤ì •        | 30ë¶„      | ğŸŸ¡       |

---

## 12. ì°¸ê³  ë¬¸ì„œ

### 12.1 í† ìŠ¤í˜ì´ë¨¼ì¸  ê³µì‹ ë¬¸ì„œ

- [ê²°ì œìœ„ì ¯ ê°€ì´ë“œ](https://docs.tosspayments.com/guides/widget)
- [ê²°ì œ ìŠ¹ì¸ API](https://docs.tosspayments.com/reference#%EA%B2%B0%EC%A0%9C-%EC%8A%B9%EC%9D%B8)
- [ì—ëŸ¬ ì½”ë“œ ëª©ë¡](https://docs.tosspayments.com/reference/error-codes)
- [í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ](https://docs.tosspayments.com/guides/test)

### 12.2 í”„ë¡œì íŠ¸ ë‚´ë¶€ ë¬¸ì„œ

- `docs/schema.md`: ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ (payments, credits í…Œì´ë¸”)
- `docs/UI_Spec.md`: UI/UX ë””ìì¸ ê°€ì´ë“œë¼ì¸
- `.cursor/agents/tosspayments-widget.md`: í† ìŠ¤í˜ì´ë¨¼ì¸  ì—°ë™ ì„œë¸Œì—ì´ì „íŠ¸

---

## ë¶€ë¡: í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

### ê°œë°œ í™˜ê²½ (.env.local)

```bash
# í† ìŠ¤í˜ì´ë¨¼ì¸  (í…ŒìŠ¤íŠ¸ í‚¤)
NEXT_PUBLIC_TOSS_CLIENT_KEY=test_ck_D5GePWvyJnrK0W0k6q8gLzN97Eoq
TOSS_SECRET_KEY=test_sk_zXLkKEypNArWmo50nX3lmeaxYG5R

# ì•± URL
NEXT_PUBLIC_APP_URL=http://localhost:3000
```

### í”„ë¡œë•ì…˜ í™˜ê²½ (Vercel)

```bash
# í† ìŠ¤í˜ì´ë¨¼ì¸  (ë¼ì´ë¸Œ í‚¤)
NEXT_PUBLIC_TOSS_CLIENT_KEY=live_ck_xxxxxxxxxxxxxxxx
TOSS_SECRET_KEY=live_sk_xxxxxxxxxxxxxxxx

# ì•± URL
NEXT_PUBLIC_APP_URL=https://signplease.kr
```

---

> **ë‹¤ìŒ ë‹¨ê³„**: Phase 1 Task 1.1ë¶€í„° ìˆœì°¨ì ìœ¼ë¡œ êµ¬í˜„ ì§„í–‰
